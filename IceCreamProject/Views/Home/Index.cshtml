@using IceCreamProject.Libary
@model IceCreamProject.Models.HomeViewModel
@{
    ViewData["Title"] = "Index";
    Layout = "~/Views/Frontend.cshtml";
}
<style>
	.tns-nav button {
    display: none;

}

</style>
<div class="hero overlay">

	<div class="img-bg rellax">
		<img src="~/Frontend/images/ice_cream_wallpaper.jpg" alt="Image" class="img-fluid">
	</div>

	<div class="container">
		<div class="row align-items-center justify-content-start">
			<div class="col-lg-5">

				<h1 class="heading" data-aos="fade-up">Discover the Sweet World of Ice Cream!</h1>
				<p class="mb-5" data-aos="fade-up">A delightful journey where every scoop tells a story. From creamy classics to adventurous flavors, your perfect treat awaits!</p>

				@* <div data-aos="fade-up">
					<a href="https://www.youtube.com/watch?v=5n-e6lOhVq0" class="play-button align-items-center d-flex glightbox3">
						<span class="icon-button me-3">
							<span class="icon-play"></span>
						</span>
						<span class="caption">Watch Video</span>
					</a>
				</div> *@
			</div>


		</div>
	</div>


</div>


<div class="section section-2">
    <section class="pb-5">
        <div class="container-lg">
            <div class="row">
                <div class="col-md-12">
                    <div class="section-header d-flex flex-wrap justify-content-between my-4">
						<h2 class="section-title">All Products</h2>
	
                        @* <div class="d-flex align-items-center">
                            <a href="#" class="btn btn-primary rounded-1">View All</a>
                        </div> *@
                    </div>
                </div>
            </div>

			<div class="row">
				<div class="col-md-12">
					<div class="product-grid row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 row-cols-xl-5 row-cols-xxl-5 gap-4">
						@foreach (var item in Model.AllProducts)
						{
							<div class="col">
								<div class="product-item"  data-group="all" data-id="@item.BookId">
									<figure>
										@if (item.IsActive == true)
										{
											<a asp-route="ProductDetails" asp-route-id="@item.BookId" asp-route-name="@UrlHelper.seoweb(@item.Title)" title="@item.Title">
												<img src="/ImageUrl/@item.ImageUrl" alt="@item.Title" class="tab-image" />
											</a>
										}
										else
										{
											<a href="javascript:void(0);" data-id="@item.BookId" onclick="viewProductDetails(@item.BookId)">
												<img src="/ImageUrl/@item.ImageUrl" alt="@item.Title" class="tab-image grayscale" />
											</a>
										}
									</figure>
									<div class="d-flex flex-column text-center">
										<h3 class="fs-6 fw-normal text-truncate" style="max-width: 150px; overflow: hidden; white-space: nowrap; margin: 0 auto;">
											@item.Title
										</h3>
										<div class="d-flex justify-content-center align-items-center gap-2">
											@if (item.Price > 20)
											{
												<del>$24.00</del>
											}
											<span class="text-dark fw-semibold">@item.Price.ToString("C")</span>
										</div>
										<div class="button-area p-3 pt-0">
											<div class="row g-1 mt-2">
												<div class="col-3">
													@if (item.IsActive == true)
													{
														<input type="number" name="quantity" id="quantity-@item.BookId"  id="quantity-all-@item.BookId"
															   class="form-control border-dark-subtle input-number quantity-all" value="1" min="1" />
													}
													else
													{
														<input type="number" name="quantity" id="quantity-@item.BookId"
															   class="form-control border-dark-subtle input-number quantity" value="1" min="1" readonly />
													}
												</div>
												<div class="col-7">
													@if (item.IsActive == true)
													{
														<a href="javascript:void(0);"
														   data-id="@item.BookId"
														   data-url="@Url.Action("AddToCart", "Home")"
														   class="btn btn-primary rounded-1 p-2 fs-7 btn-cart add-to-cart">
															Add to Cart
														</a>
													}
													else
													{
														<a href="javascript:void(0);"
														   data-id="@item.BookId"
														   data-url="@Url.Action("AddToCart", "Home")"
														   class="btn btn-dark rounded-1 p-2 fs-7 btn-cart add-to-cart">
															Sold Out
														</a>
													}
												</div>
												<div class="col-2">
													@if (item.IsActive == true)
													{
														<a asp-route="ProductDetails" asp-route-id="@item.BookId" asp-route-name="@UrlHelper.seoweb(@item.Title)" class="btn btn-primary rounded-1 p-2 fs-6">
															<i class="bi bi-three-dots"></i>
														</a>
													}
													else
													{
														<a href="javascript:void(0);" data-id="@item.BookId" class="btn btn-dark rounded-1 p-2 fs-6" onclick="viewProductDetails(@item.BookId)">
															<i class="bi bi-three-dots"></i>
														</a>
													}
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
						}


					</div>
					<!-- / product-grid -->
				</div>
			</div>


        </div>
    </section>


	
</div>

<div class="section service-section-1">
	<div class="container">
		<div class="row">

			<div class="col-lg-3 mb-4 mb-lg-0">
				<div class="heading-content" data-aos="fade-up">
					<h2>Our <span class="d-block">Services</span></h2>
					<p>Welcome to Mr. Amber Ice Cream Parlor! Explore our delicious range of ice creams, recipes, and more.</p>
@* 					<p class="my-4" data-aos="fade-up" data-aos-delay="300"><a href="#" class="btn btn-primary">View All</a></p>
 *@				</div>
			</div>
			<div class="col-lg-9">
				<div class="row">
					<div class="col-6 col-md-6 col-lg-3 mb-4 mb-lg-0" data-aos="fade-up" data-aos-delay="100">
						<div class="service-1">
							<span class="icon">
								<img src="~/Frontend/images/ice-cream-cone.png" alt="Ice Cream" class="img-fluid">
							</span>
							<div>
								<h3>Ice Cream Flavors</h3>
								<p>Discover our wide range of delightful and unique ice cream flavors, crafted with love.</p>
							</div>
						</div>
					</div>
					<div class="col-6 col-md-6 col-lg-3 mb-4 mb-lg-0" data-aos="fade-up" data-aos-delay="200">
						<div class="service-1">
							<span class="icon">
								<img src="~/Frontend/images/1791076.png" alt="Recipes" class="img-fluid">
							</span>
							<div>
								<h3>Exclusive Recipes</h3>
								<p>Registered customers can access exclusive recipes for delicious desserts and ice creams.</p>
							</div>
						</div>
					</div>
					<div class="col-6 col-md-6 col-lg-3 mb-4 mb-lg-0" data-aos="fade-up" data-aos-delay="300">
						<div class="service-1">
							<span class="icon">
								<img src="~/Frontend/images/menu.png" alt="Books" class="img-fluid">
							</span>
							<div>
								<h3>Recipe Books</h3>
								<p>Explore and purchase Mr. A's exclusive recipe books, now available online!</p>
							</div>
						</div>
					</div>
					<div class="col-6 col-md-6 col-lg-3 mb-4 mb-lg-0" data-aos="fade-up" data-aos-delay="400">
						<div class="service-1">
							<span class="icon">
								<img src="~/Frontend/images/book.png" alt="Competitions" class="img-fluid">
							</span>
							<div>
								<h3>Recipe Competitions</h3>
								<p>Submit your recipes and stand a chance to win exciting prizes and recognition!</p>
							</div>
						</div>
					</div>
				</div>
			</div>

		</div>
	</div>
</div>


<div class="section section-3" data-aos="fade-up" data-aos-delay="100">
	<div class="container">
		<div class="row align-items-center justify-content-between  mb-5">
			<div class="col-lg-5" data-aos="fade-up">
				<h2 class="heading mb-3">Best Selling</h2>
				<p>Indulge in our most loved and best-selling ice creams, carefully crafted to satisfy every craving. From classic flavors to unique creations, discover why these frozen delights are everyone’s favorite. Treat yourself today!</p>
			</div>
			<div class="col-lg-5 text-md-end" data-aos="fade-up" data-aos-delay="100">
				<div id="destination-controls">
					<span class="prev me-3" data-controls="prev">
						<span class="icon-chevron-left"></span>

					</span>
					<span class="next" data-controls="next">
						<span class="icon-chevron-right"></span>

					</span>
				</div>
			</div>
		</div>

	</div>

	<div class="destination-slider-wrap">
		<div class="destination-slider mt-5 mb-5">
			@foreach (var item in Model.BestSellingProducts.Where(p => p.IsActive))
			{
				<div class="destination mb-5">
					<div class="col">
						<div class="product-item" data-group="best" data-id="@item.BookId">
							<figure>
								@if (item.IsActive)
								{
									<a asp-route="ProductDetails" asp-route-id="@item.BookId" asp-route-name="@UrlHelper.seoweb(@item.Title)" title="@item.Title">
										<img src="/ImageUrl/@item.ImageUrl" alt="@item.Title" class="tab-image" />
									</a>
								}
								else
								{
									<a href="javascript:void(0);" data-id="@item.BookId" onclick="viewProductDetails(@item.BookId)">
										<img src="/ImageUrl/@item.ImageUrl" alt="@item.Title" class="tab-image grayscale" />
									</a>
								}
							</figure>
							<div class="d-flex flex-column text-center">
								<h3 class="fs-6 fw-normal text-truncate" style="max-width: 150px; overflow: hidden; white-space: nowrap; margin: 0 auto;">
									@item.Title
								</h3>
								<div class="d-flex justify-content-center align-items-center gap-2">
									@if (item.Price > 20)
									{
										<del>$24.00</del>
									}
									<span class="text-dark fw-semibold">@item.Price.ToString("C")</span>
								</div>
								<div class="button-area p-3 pt-0">
									<div class="row g-1 mt-2">
										<div class="col-3">
											<input type="number" name="quantity" id="quantity-@item.BookId"  id="quantity-best-@item.BookId"
															   class="form-control border-dark-subtle input-number quantity-best" value="1" min="1" />
										</div>
										<div class="col-7">
											<a href="javascript:void(0);"
														   data-id="@item.BookId"
														   data-url="@Url.Action("AddToCart", "Home")"
														   class="btn btn-primary rounded-1 p-2 fs-7 btn-cart add-to-cart">
															Add to Cart
														</a>
										</div>
										<div class="col-2">
											@if (item.IsActive)
											{
												<a asp-route="ProductDetails" asp-route-id="@item.BookId" asp-route-name="@UrlHelper.seoweb(@item.Title)"
												   class="btn btn-primary rounded-1 p-2 fs-6">
													<i class="bi bi-three-dots"></i>
												</a>
											}
											else
											{
												<a href="javascript:void(0);" data-id="@item.BookId"
												   class="btn btn-dark rounded-1 p-2 fs-6" onclick="viewProductDetails(@item.BookId)">
													<i class="bi bi-three-dots"></i>
												</a>
											}
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			}
		</div>
	</div>

</div>




<div class="section bg-light">


	<h2 class="heading mb-5 text-center"> New Products</h2>

	<div class="text-center mb-5">
		<div id="prevnext-testimonial">
    <span class="prev me-3" data-controls="prev">
        <span class="icon-chevron-left"></span>
    </span>
    <span class="next" data-controls="next">
        <span class="icon-chevron-right"></span>
    </span>
</div>

	</div>

	<div class="wide-slider-testimonial">
		@foreach (var item in Model.NewProducts.Where(p => p.IsActive))
		{
			<div class="item">
				<blockquote class="block-testimonial">
					<div class="destination mb-5">
						<div class="col">
							<div class="product-item" data-group="new" data-id="@item.BookId">
								<figure>
									@if (item.IsActive)
									{
										<a asp-route="ProductDetails" asp-route-id="@item.BookId" asp-route-name="@UrlHelper.seoweb(@item.Title)" title="@item.Title">
											<img src="/ImageUrl/@item.ImageUrl" alt="@item.Title" class="tab-image" />
										</a>
									}
									else
									{
										<a href="javascript:void(0);" data-id="@item.BookId" onclick="viewProductDetails(@item.BookId)">
											<img src="/ImageUrl/@item.ImageUrl" alt="@item.Title" class="tab-image grayscale" />
										</a>
									}
								</figure>	
								<div class="d-flex flex-column text-center">
									<h3 class="fs-6 fw-normal text-truncate" style="max-width: 150px; overflow: hidden; white-space: nowrap; margin: 0 auto;">
										@item.Title
									</h3>
									<div class="d-flex justify-content-center align-items-center gap-2">
										@if (item.Price > 20)
										{
											<del>$24.00</del>
										}
										<span class="text-dark fw-semibold">@item.Price.ToString("C")</span>
									</div>
									<div class="button-area p-3 pt-0">
										<div class="row g-1 mt-2">
											<div class="col-3">
												<input type="number" name="quantity" id="quantity-@item.BookId" id="quantity-new-@item.BookId"
															   class="form-control border-dark-subtle input-number quantity-new" value="1" min="1" />
											</div>
											<div class="col-7">
												<a href="javascript:void(0);"
														   data-id="@item.BookId"
														   data-url="@Url.Action("AddToCart", "Home")"
														   class="btn btn-primary rounded-1 p-2 fs-7 btn-cart add-to-cart">
															Add to Cart
														</a>
											</div>
											<div class="col-2">
												@if (item.IsActive)
												{
													<a asp-route="ProductDetails" asp-route-id="@item.BookId" asp-route-name="@UrlHelper.seoweb(@item.Title)"
													   class="btn btn-primary rounded-1 p-2 fs-6">
														<i class="bi bi-three-dots"></i>
													</a>
												}
												else
												{
													<a href="javascript:void(0);" data-id="@item.BookId"
													   class="btn btn-dark rounded-1 p-2 fs-6" onclick="viewProductDetails(@item.BookId)">
														<i class="bi bi-three-dots"></i>
													</a>
												}
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</blockquote>
			</div>
		}
	</div>


</div> 

<div class="section">
	<div class="container">
		<div class="row justify-content-between align-items-center">
			<div class="col-lg-5 mb-4 mb-lg-0 order-lg-2" data-aos="fade-up">
				<img src="~/Frontend/images/snapedit_1736131230703.jpeg" alt="Image" class="img-fluid">
			</div>
			<div class="col-lg-5" data-aos="fade-up" data-aos-delay="100">
				<h2 class="heading mb-4">Mr Amber </h2>
				<p>
					Mr. Amber began his career with a small ice cream shop, driven by a deep passion for creating unique and high-quality desserts.
					Over time, his dedication and innovative approach to ice cream making earned him a reputation as a master in his craft, leading to the rapid growth of his business and the expansion of multiple branches. Recognizing the evolving demands of the modern market, Mr. A envisioned a way to connect more personally with his customers, both locally and globally..
				</p>
				<p class="read-more-content" style="display: none;">
					The purpose of creating this website is to extend the reach of his brand and make his creations more accessible. Through the website, Mr. A aims to offer exclusive recipes to registered customers, allowing them to recreate his famous desserts at home. Additionally, the site serves as a platform to sell his recipe books, giving dessert enthusiasts a chance to own a piece of his expertise. By hosting recipe competitions, Mr. A also seeks to inspire creativity and engagement within the community, fostering a space where customers can contribute their ideas and feel valued. Ultimately, the website represents Mr. A's mission to blend tradition with innovation,
					bringing people closer to the art of ice cream making while growing his business in the digital age.
				</p>
				<p class="my-4" data-aos="fade-up" data-aos-delay="200"><a href="#" class="btn btn-primary read-more-toggle">Read more</a></p>
			</div>
		</div>
	</div>
</div>

<script>
	document.addEventListener('DOMContentLoaded', function () {
		const toggleButton = document.querySelector('.read-more-toggle');
		const content = document.querySelector('.read-more-content');

		toggleButton.addEventListener('click', function (e) {
			e.preventDefault();
			if (content.style.display === 'none') {
				content.style.display = 'block';
				toggleButton.textContent = 'Read less';
			} else {
				content.style.display = 'none';
				toggleButton.textContent = 'Read more';
			}
		});
	});
</script>



<script>
	$(document).ready(function () {
    const notyf = new Notyf();

    // Cập nhật số lượng giỏ hàng
    function updateCartCount() {
        $.get("/count-cart", function (data) {
            $(".count-item-only").text(data.totalItems);
        }).fail(function () {
            notyf.error("Failed to fetch cart count.");
        });
    }

    // Xử lý sự kiện khi nhấn nút "Add to Cart"
    $(document).on("click", ".add-to-cart", function () {
        const $button = $(this); // Nút Add to Cart
        const $productItem = $button.closest(".product-item"); // Lấy sản phẩm liên quan
        const bookId = $productItem.data("id"); // Lấy ID sản phẩm
        const url = $button.data("url"); // URL để gửi request
        const group = $productItem.data("group"); // Nhóm sản phẩm (all, best, new)

        // Xác định input số lượng dựa vào nhóm sản phẩm
        let $quantityInput;
        if (group === "all") {
            $quantityInput = $(`#quantity-all-${bookId}`);
        } else if (group === "best") {
            $quantityInput = $(`#quantity-best-${bookId}`);
        } else if (group === "new") {
            $quantityInput = $(`#quantity-new-${bookId}`);
        }

        // Lấy giá trị số lượng từ input
        const quantity = parseInt($quantityInput.val());

        // Kiểm tra tính hợp lệ của số lượng
        if (isNaN(quantity) || quantity <= 0) {
            notyf.error("Quantity must be a number greater than 0.");
            return;
        }

        // Gửi yêu cầu AJAX để thêm sản phẩm vào giỏ hàng
        $.post(url, { BookId: bookId, quantity: quantity }, function (response) {
            if (response.success) {
                updateCartCount(); // Cập nhật giỏ hàng
                notyf.success(response.message || "Product added to cart successfully!");
            } else {
                notyf.error(response.message || "An error occurred while adding the product.");
            }
        }).fail(function () {
            notyf.error("An error occurred while adding the product.");
        });
    });

    // Cập nhật giỏ hàng khi tải trang
    updateCartCount();
});

	</script>
<a href="@Url.Action("SubmitRecipe", "Home")" class="btn btn-primary">Đăng Công Thức</a>